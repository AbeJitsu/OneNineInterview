---
description: Draft a commit message
allowed-tools: Bash(git status:*), Bash(git diff:*), Bash(git log:*), Bash(git add:*), Bash(git commit:*), Bash(git push:*)
---
# Draft a Commit

Look at the changes that are ready to save and write a commit message that's inviting, focused, considerate, supportive, and influential.

## Change Categorization

Detect change type from file patterns to choose the right prefix:

| Pattern                                       | Prefix        | Example                             |
| --------------------------------------------- | ------------- | ----------------------------------- |
| `*.test.*`, `*.spec.*`, `e2e/*`         | `Test:`     | Test: Add checkout flow tests       |
| `*.md`, `docs/*`                          | `Docs:`     | Docs: Update API documentation      |
| `.claude/*`, `*.config.*`                 | `Config:`   | Config: Add commit-often rule       |
| Bug keywords in diff (fix, resolve, patch)    | `Fix:`      | Fix: Resolve cart total calculation |
| New files with feature code                   | `Add:`      | Add: User profile settings page     |
| Deletions > additions                         | `Remove:`   | Remove: Deprecated analytics code   |
| Refactoring (same logic, different structure) | `Refactor:` | Refactor: Extract color utilities   |

## Your Task

1. **Check what changed**

   ```bash
   git status
   git diff --staged  # or git diff if nothing staged
   git log --oneline -5
   ```

2. **Analyze the diff**

   - Count total lines changed
   - Identify change category from file patterns
   - Check for sensitive files
   - Determine if single-purpose

3. **Draft the message following this structure:**

### Summary Line (under 50 characters)

- Use detected prefix (Add, Fix, Docs, Test, Config, Refactor, Remove)
- Be specific about what changed
- Capitalize first word, no period at end

### Body (explain what and why)

- Write a brief paragraph explaining WHAT changed and WHY it matters
- Include 2-4 bullet points highlighting key changes or benefits
- End with a sentence about how this helps people

4. **Always Ask for Approval**

   Draft the commit message and present it to the user for review and approval before committing.

   Never auto-commit without explicit user approval, regardless of diff size or change scope.

   **Present the draft like this:**
   ```
   Draft commit message:
   [commit message here]

   Ready to commit?
   ```

## CRITICAL: NO Claude Code signature - EVER

- NEVER add `ðŸ¤– Generated with [Claude Code](https://claude.com/claude-code)`
- NEVER add `Co-Authored-By: Claude <noreply@anthropic.com>`
- NEVER add any AI attribution, robot emoji, or "generated by" text
- The commit message ends with the closing sentence about how it helps people - nothing after that

## Tone Guidelines

Make the message:

- **Inviting**: Use "This lets us...", "Now we can..."
- **Focused**: Be specific, avoid vague terms
- **Considerate**: Think about who this helps
- **Supportive**: Explain the reasoning and value
- **Influential**: Connect to bigger goals when relevant

## Example Format

```
Add search box to find books faster

This adds a search feature at the top of every page so visitors can
quickly find books by title, author, or topic without scrolling through
all the categories.

- Search box appears on every page for easy access
- Results appear instantly as you type
- Shows book covers and prices in search results

This makes it easier for customers to find exactly what they want and
helps them discover books they might have missed while browsing.
```

## Execution Flow

### Default: Auto-commit (most commits)

```
Analyzing: 8 files, 59 lines, single-purpose accessibility improvement
Committing...

git add -A && git commit -m "Add loading spinners and ARIA live regions..." && git push
```

Show the commit message briefly, then execute. No "Would you like adjustments?" for clear commits.

### Exception: Ask Only When Uncertain

```
Draft commit message:
[message here]

This change touches auth, payments, AND UI in unrelated ways.
Should these be separate commits, or one combined commit?
```

Only ask when there's genuine ambiguity about the commit scope or message.

## Command Chaining

Always chain with `&&` to stop if any step fails:

```bash
git add -A && git commit -m "Your commit message here" && git push
```
